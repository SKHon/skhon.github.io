---
title: node端请求库选型
date: 2020-06-08 16:25:24
categories: 前端
tags: [JavaScript]
comments: true
copyright: true
---

## 背景
项目之前node端http请求库用端request，由于request后续不维护了，所以，为了后续项目更好的迭代，就打算换一个。<!--more-->

## 需要考虑的因素
需要考虑的因素有这么几个方面：
1. 性能问题。之前压过request的性能，基于我们项目qps大概能压到1000所有。那用的新的请求库，qps不应该低于1000，要不然业务方会找你的。

2. 兼容问题。别我们选完了，发了新版本，最后业务方说我们的服务不能用了，当然，如果非要业务方做一些改动来适配，那也可以，但是尽量让业务方改动最小，不然他们会觉得你的这个框架很low，尽管他不会关注你框架的实现。当然，兼容问题不光是业务方的项目代码，还有node版本，有的请求库要求的node版本不一样，而业务方线上环境的node大多是在v8.6.0.如果你的框架node需要更高的版本，还需要线上环境的node升级，这个时候，业务方又觉得你的框架有点low。

3. 框架自身。框架本身好不好使用，也是一个问题，别你选了一个请求库，最后发现，自己都觉得超级复杂，那我觉得还是算了吧，后续迭代，如果出了什么问题，或者需要加个什么需求，你会痛苦死的。

4. 框架生态。看看框架生态活不活跃，如果不活跃了，你想提个issue，发现一百年没人理你，一看open的issue一堆，没人管，那也算了吧，出了问题，估计需要你动手改请求库的源码了。

5. 使用数量。这个指标其实是一个参考性，用的人多，说明这个框架还是受人青睐的，群众的眼睛还是雪亮的，所以，需要参考一下。

## 几个node请求库

由于我们项目之前用的request，所以，看看别的库吧。

1. [got](https://github.com/sindresorhus/got#readme)
这个库我看了一下，什么都挺好的，就有一点，node版本需要10.19.0以上，所以就pass了吧，我们公司线上的node环境很多是8.6.0的。

2. [axios](https://github.com/axios/axios)
> 先看性能，压了一下，基本和request的差不多，所以，这方面可以接受
> 兼容问题，这个有返回的response结构，和request的不一样，改动比较多，node版本倒是没啥问题，符合我们公司线上的node版本。
> 框架自身也也比较好使
> 生态比较丰富
> 用的人也挺多的。

3. [Superagent](https://github.com/visionmedia/superagent)
> 主要是插件式写法，和之前request的使用方式差别比较大，就算了吧，要不然，给之前用户带来的风险很大。

4. [node-fetch](https://github.com/node-fetch/node-fetch#options)
> 功能不是很全，覆盖不了之前的功能，就算了吧。

所以，选择axios吧。
